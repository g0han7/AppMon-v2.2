SELECT TGFCAB.AD_APROVDEVCAN AS AD_APROVDEVCAN,TGFCAB.AD_ATENDEPEDLV AS AD_ATENDEPEDLV,TGFCAB.AD_CLASDEV AS AD_CLASDEV,TGFCAB.AD_CLASSIFICACAOWASTE AS AD_CLASSIFICACAOWASTE,TGFCAB.AD_CODBEM AS AD_CODBEM,TGFCAB.AD_CODLOCAL AS AD_CODLOCAL,TGFCAB.AD_CODOBJCORREIOLV AS AD_CODOBJCORREIOLV,TGFCAB.AD_CODPARLV AS AD_CODPARLV,TGFCAB.AD_CODPEDLV AS AD_CODPEDLV,TGFCAB.AD_CODREG AS AD_CODREG,TGFCAB.AD_CODTIPTIT AS AD_CODTIPTIT,TGFCAB.AD_CODUSU AS AD_CODUSU,TGFCAB.AD_CODUSUCONF AS AD_CODUSUCONF,TGFCAB.AD_CODUSUDEVCAN AS AD_CODUSUDEVCAN,TGFCAB.AD_COMPRAURG AS AD_COMPRAURG,TGFCAB.AD_CONSULTOR AS AD_CONSULTOR,TGFCAB.AD_CREDCONSULV AS AD_CREDCONSULV,TGFCAB.AD_DEVCAN
AS AD_DEVCAN,TGFCAB.AD_DHSOLDEVCAN AS AD_DHSOLDEVCAN,TGFCAB.AD_DTEXP AS AD_DTEXP,TGFCAB.AD_DTNEG AS AD_DTNEG,TGFCAB.AD_DTPREVENT2 AS AD_DTPREVENT2,TGFCAB.AD_DTPREVENT3 AS AD_DTPREVENT3,TGFCAB.AD_DTPREVPROGRAMADA AS AD_DTPREVPROGRAMADA,TGFCAB.AD_DTREFPLAN AS AD_DTREFPLAN,TGFCAB.AD_EMAILNFCE AS AD_EMAILNFCE,TGFCAB.AD_EMPDEST AS AD_EMPDEST,TGFCAB.AD_EMPSPED AS AD_EMPSPED,TGFCAB.AD_EMPTRANDEST AS AD_EMPTRANDEST,TGFCAB.AD_ENDENVIOLV AS AD_ENDENVIOLV,TGFCAB.AD_ENDVTEX AS AD_ENDVTEX,TGFCAB.AD_FLOW AS AD_FLOW,TGFCAB.AD_FORMAPGTOLV AS AD_FORMAPGTOLV,TGFCAB.AD_GARANTIA AS AD_GARANTIA,TGFCAB.AD_GESTOR AS AD_GESTOR,TGFCAB.AD_IDAFILIADOVTEX AS AD_IDAFILIADOVTEX,TGFCAB.AD_IDCABMOV AS AD_IDCABMOV,TGFCAB.AD_IDCLIORGEVELV AS AD_IDCLIORGEVELV,TGFCAB.AD_IDEVENTOLV AS AD_IDEVENTOLV,TGFCAB.AD_IDFIREBASE AS AD_IDFIREBASE,TGFCAB.AD_IDFIREBASEGCOPER AS AD_IDFIREBASEGCOPER,TGFCAB.AD_IMAGECANHOTO AS AD_IMAGECANHOTO,TGFCAB.AD_IMPORTNESPRESSO AS AD_IMPORTNESPRESSO,TGFCAB.AD_LOCALWASTE AS AD_LOCALWASTE,TGFCAB.AD_LOCDEST AS AD_LOCDEST,TGFCAB.AD_LOGISTICTYPE AS AD_LOGISTICTYPE,TGFCAB.AD_METPAGLV AS AD_METPAGLV,TGFCAB.AD_MOTENTREGA AS AD_MOTENTREGA,TGFCAB.AD_MOTIVO AS AD_MOTIVO,TGFCAB.AD_MOTOUTROS_WASTE AS AD_MOTOUTROS_WASTE,TGFCAB.AD_NOSSONUMLV AS AD_NOSSONUMLV,TGFCAB.AD_NROCOMPRA AS AD_NROCOMPRA,TGFCAB.AD_NROCONTRATO AS AD_NROCONTRATO,TGFCAB.AD_NROPEDREMESSA AS AD_NROPEDREMESSA,TGFCAB.AD_NRPATRIMONIO AS AD_NRPATRIMONIO,TGFCAB.AD_NUFATURA AS AD_NUFATURA,TGFCAB.AD_NUMPLAN AS AD_NUMPLAN,TGFCAB.AD_NUNOTABAI AS AD_NUNOTABAI,TGFCAB.AD_NUNOTAENT AS AD_NUNOTAENT,TGFCAB.AD_OBSDEV AS AD_OBSDEV,TGFCAB.AD_OBSERVACAOLV AS AD_OBSERVACAOLV,TGFCAB.AD_ORGEVENTOLV AS AD_ORGEVENTOLV,TGFCAB.AD_ORIGEMCONTRATO AS AD_ORIGEMCONTRATO,TGFCAB.AD_PATRIMONIO AS AD_PATRIMONIO,TGFCAB.AD_PCPMRP AS AD_PCPMRP,TGFCAB.AD_PEDECOMMERCE AS AD_PEDECOMMERCE,TGFCAB.AD_PEDIDOVTEX AS AD_PEDIDOVTEX,TGFCAB.AD_QTDNEG
AS AD_QTDNEG,TGFCAB.AD_QTDPARCELASLV AS AD_QTDPARCELASLV,TGFCAB.AD_REMASSINATURA AS AD_REMASSINATURA,TGFCAB.AD_REMESSADEPOSITO AS AD_REMESSADEPOSITO,TGFCAB.AD_REMESSAJOB AS AD_REMESSAJOB,TGFCAB.AD_SETOR AS AD_SETOR,TGFCAB.AD_SOLICITANTE AS AD_SOLICITANTE,TGFCAB.AD_STATUSCONF AS AD_STATUSCONF,TGFCAB.AD_STATUSENTREGA AS AD_STATUSENTREGA,TGFCAB.AD_STATUSVALOR AS AD_STATUSVALOR,TGFCAB.AD_STPEDLV AS AD_STPEDLV,TGFCAB.AD_TIDCARTAOLV AS AD_TIDCARTAOLV,TGFCAB.AD_TIPO AS AD_TIPO,TGFCAB.AD_TIPOECOMM AS AD_TIPOECOMM,TGFCAB.AD_TIPOEVENTOLV AS AD_TIPOEVENTOLV,TGFCAB.AD_VALIDFISCALXML AS AD_VALIDFISCALXML,TGFCAB.AD_VALPAR AS AD_VALPAR,TGFCAB.AD_VALRESNOTA AS AD_VALRESNOTA,TGFCAB.AD_VLRCOMISSAO AS AD_VLRCOMISSAO,TGFCAB.AD_VLRCOMISSAOSFG AS AD_VLRCOMISSAOSFG,TGFCAB.AD_VLRFRETEGRATIS AS AD_VLRFRETEGRATIS,TGFCAB.AD_WASTE AS AD_WASTE,TGFCAB.AGRUPFINNOTA AS AGRUPFINNOTA,TGFCAB.ALIQIRF AS ALIQIRF,TGFCAB.ANTT AS ANTT,TGFCAB.APROVADO AS APROVADO,TGFCAB.BASECOFINS AS BASECOFINS,TGFCAB.BASECOFINSST AS BASECOFINSST,TGFCAB.BASEICMS AS BASEICMS,TGFCAB.BASEICMSAT AS BASEICMSAT,TGFCAB.BASEICMSFRETE AS BASEICMSFRETE,TGFCAB.BASEICMSSTFRETE AS BASEICMSSTFRETE,TGFCAB.BASEINSS AS BASEINSS,TGFCAB.BASEIPI AS BASEIPI,TGFCAB.BASEIRF AS BASEIRF,TGFCAB.BASEISS AS BASEISS,TGFCAB.BASEPIS AS BASEPIS,TGFCAB.BASEPISST AS BASEPISST,TGFCAB.BASESUBSTIT AS BASESUBSTIT,TGFCAB.BASESUBSTSEMRED AS BASESUBSTSEMRED,TGFCAB.CARACAD AS CARACAD,TGFCAB.CARACSER AS CARACSER,TGFCAB.CHAVECTE AS CHAVECTE,TGFCAB.CHAVECTEREF AS CHAVECTEREF,TGFCAB.CHAVENFCOM AS CHAVENFCOM,TGFCAB.CHAVENFE AS CHAVENFE,TGFCAB.CHAVENFEREF AS CHAVENFEREF,TGFCAB.CHAVENFSE AS CHAVENFSE,TGFCAB.CHAVESINIEF1324 AS CHAVESINIEF1324,TGFCAB.CHVNFEINEREF AS CHVNFEINEREF,TGFCAB.CIF_FOB
AS CIF_FOB,TGFCAB.CIOT AS CIOT,TGFCAB.CLASCONS AS CLASCONS,TGFCAB.CLASSIFICMS AS CLASSIFICMS,TGFCAB.CLIENTEIDPARCERIA AS CLIENTEIDPARCERIA,TGFCAB.CNPJADQUIRENTE AS CNPJADQUIRENTE,TGFCAB.CODART AS CODART,TGFCAB.CODCC AS CODCC,TGFCAB.CODCENCUS AS CODCENCUS,TGFCAB.CODCHECKOUT AS CODCHECKOUT,TGFCAB.CODCID AS CODCID,TGFCAB.CODCIDDESTINO AS CODCIDDESTINO,TGFCAB.CODCIDENTREGA AS CODCIDENTREGA,TGFCAB.CODCIDFIMCTE AS CODCIDFIMCTE,TGFCAB.CODCIDINICTE AS CODCIDINICTE,TGFCAB.CODCIDORIGEM AS CODCIDORIGEM,TGFCAB.CODCIDPREST AS CODCIDPREST,TGFCAB.CODCONTATO AS CODCONTATO,TGFCAB.CODCONTATOENTREGA AS CODCONTATOENTREGA,TGFCAB.CODDOCA AS CODDOCA,TGFCAB.CODDOCARRECAD AS CODDOCARRECAD,TGFCAB.CODEMP AS CODEMP,TGFCAB.CODEMPFUNC AS CODEMPFUNC,TGFCAB.CODEMPNEGOC AS CODEMPNEGOC,TGFCAB.CODFUNC AS CODFUNC,TGFCAB.CODGRUPOTENSAO AS CODGRUPOTENSAO,TGFCAB.CODGUF AS CODGUF,TGFCAB.CODINTERM AS CODINTERM,TGFCAB.CODMAQ AS CODMAQ,TGFCAB.CODMODDOCNOTA AS CODMODDOCNOTA,TGFCAB.CODMOEDA AS CODMOEDA,TGFCAB.CODMOTORISTA AS CODMOTORISTA,TGFCAB.CODNAT AS CODNAT,TGFCAB.CODOBRA AS CODOBRA,TGFCAB.CODOBSPADRAO AS CODOBSPADRAO,TGFCAB.CODPARC AS CODPARC,TGFCAB.CODPARCCONSIGNATARIO AS CODPARCCONSIGNATARIO,TGFCAB.CODPARCDESCARGAMDFE AS CODPARCDESCARGAMDFE,TGFCAB.CODPARCDEST AS CODPARCDEST,TGFCAB.CODPARCREDESPACHO AS CODPARCREDESPACHO,TGFCAB.CODPARCREMETENTE AS CODPARCREMETENTE,TGFCAB.CODPARCRETIRADA AS CODPARCRETIRADA,TGFCAB.CODPARCTRANSP AS CODPARCTRANSP,TGFCAB.CODPARCTRANSPFINAL AS CODPARCTRANSPFINAL,TGFCAB.CODPROJ AS CODPROJ,TGFCAB.CODRASTREAMENTOECT AS CODRASTREAMENTOECT,TGFCAB.CODSITE AS CODSITE,TGFCAB.CODTIPOPER AS CODTIPOPER,TGFCAB.CODTIPVENDA AS CODTIPVENDA,TGFCAB.CODTPD AS CODTPD,TGFCAB.CODUFDESTINO
AS CODUFDESTINO,TGFCAB.CODUFENTREGA AS CODUFENTREGA,TGFCAB.CODUFORIGEM AS CODUFORIGEM,TGFCAB.CODUSU AS CODUSU,TGFCAB.CODUSUCOMPRADOR AS CODUSUCOMPRADOR,TGFCAB.CODUSUINC AS CODUSUINC,TGFCAB.CODVEICULO AS CODVEICULO,TGFCAB.CODVEND AS CODVEND,TGFCAB.CODVENDTEC AS CODVENDTEC,TGFCAB.CODVTP AS CODVTP,TGFCAB.COMGER AS COMGER,TGFCAB.COMISSAO AS COMISSAO,TGFCAB.CONFIRMNOTAFAT AS CONFIRMNOTAFAT,TGFCAB.CPFCNPJADQUIRENTE AS CPFCNPJADQUIRENTE,TGFCAB.CPFRESPTEC AS CPFRESPTEC,TGFCAB.CTEGLOBAL AS CTEGLOBAL,TGFCAB.CTELOTACAO AS CTELOTACAO,TGFCAB.DANFE AS DANFE,TGFCAB.DHEMISSEPEC AS DHEMISSEPEC,TGFCAB.DHPROTOC AS DHPROTOC,TGFCAB.DHPROTOCCTE AS DHPROTOCCTE,TGFCAB.DHREGDPEC AS DHREGDPEC,TGFCAB.DHTIPOPER AS DHTIPOPER,TGFCAB.DHTIPVENDA AS DHTIPVENDA,TGFCAB.DHVIAGEM AS DHVIAGEM,TGFCAB.DIGITAL AS DIGITAL,TGFCAB.DIRECAOVIAG AS DIRECAOVIAG,TGFCAB.DISDESAUTIMPEMB AS DISDESAUTIMPEMB,TGFCAB.DTADIAM AS DTADIAM,TGFCAB.DTALTER AS DTALTER,TGFCAB.DTCONTAB AS DTCONTAB,TGFCAB.DTDECLARA AS DTDECLARA,TGFCAB.DTENTSAI AS DTENTSAI,TGFCAB.DTENTSAIINFO AS DTENTSAIINFO,TGFCAB.DTENVIOPMB AS DTENVIOPMB,TGFCAB.DTENVSUF AS DTENVSUF,TGFCAB.DTESCRCONT AS DTESCRCONT,TGFCAB.DTFATUR AS DTFATUR,TGFCAB.DTMOV AS DTMOV,TGFCAB.DTNEG AS DTNEG,TGFCAB.DTPREVENT AS DTPREVENT,TGFCAB.DTREF AS DTREF,TGFCAB.DTREF2 AS DTREF2,TGFCAB.DTREF3 AS DTREF3,TGFCAB.DTREMRET AS DTREMRET,TGFCAB.DTVAL AS DTVAL,TGFCAB.EXIGEISSQN AS EXIGEISSQN,TGFCAB.FISTEL AS FISTEL,TGFCAB.FORMPGTCTE AS FORMPGTCTE,TGFCAB.FRETEVLRPAGO AS FRETEVLRPAGO,TGFCAB.FUSOEMISSEPEC
AS FUSOEMISSEPEC,TGFCAB.HISTCONFIG AS HISTCONFIG,TGFCAB.HRADIAM AS HRADIAM,TGFCAB.HRENTSAI AS HRENTSAI,TGFCAB.HRMOV AS HRMOV,TGFCAB.ICMSFRETE AS ICMSFRETE,TGFCAB.ICMSSTFRETE AS ICMSSTFRETE,TGFCAB.IDBALSA01 AS IDBALSA01,TGFCAB.IDBALSA02 AS IDBALSA02,TGFCAB.IDBALSA03 AS IDBALSA03,TGFCAB.IDDESCPARCERIA AS IDDESCPARCERIA,TGFCAB.IDIPROC AS IDIPROC,TGFCAB.IDNAVIO AS IDNAVIO,TGFCAB.IDPONTUACAOPARCERIA AS IDPONTUACAOPARCERIA,TGFCAB.INDNEGMODAL AS INDNEGMODAL,TGFCAB.INDPRESNFCE AS INDPRESNFCE,TGFCAB.INTERMED AS INTERMED,TGFCAB.IPIEMB AS IPIEMB,TGFCAB.IRFRETIDO AS IRFRETIDO,TGFCAB.IRINNAVIO AS IRINNAVIO,TGFCAB.ISSRETIDO AS ISSRETIDO,TGFCAB.KMVEICULO AS KMVEICULO,TGFCAB.LACRES AS LACRES,TGFCAB.LATITUDE AS LATITUDE,TGFCAB.LIBCONF AS LIBCONF,TGFCAB.LOCALCOLETA AS LOCALCOLETA,TGFCAB.LOCALENTREGA AS LOCALENTREGA,TGFCAB.LOCEMBARQ AS LOCEMBARQ,TGFCAB.LONGITUDE AS LONGITUDE,TGFCAB.LOTACAO AS LOTACAO,TGFCAB.M3 AS M3,TGFCAB.MARCA AS MARCA,TGFCAB.MD5MODCOMTEL AS MD5MODCOMTEL,TGFCAB.MODELONFDES AS MODELONFDES,TGFCAB.MODENTREGA AS MODENTREGA,TGFCAB.MODRECEBPDVWEB AS MODRECEBPDVWEB,TGFCAB.MOTNAORETERISSQN AS MOTNAORETERISSQN,TGFCAB.NATUREZAOPERDES AS NATUREZAOPERDES,TGFCAB.NFEDEVRECUSA AS NFEDEVRECUSA,TGFCAB.NFSEID AS NFSEID,TGFCAB.NOMEADQUIRENTE AS NOMEADQUIRENTE,TGFCAB.NOTAEMPENHO AS NOTAEMPENHO,TGFCAB.NOTAPORPEDIDOPDV AS NOTAPORPEDIDOPDV,TGFCAB.NOTASCF AS NOTASCF,TGFCAB.NROCAIXA AS NROCAIXA,TGFCAB.NROREDZ AS NROREDZ,TGFCAB.NUCFR AS NUCFR,TGFCAB.NUCONFATUAL AS NUCONFATUAL,TGFCAB.NUFOP AS NUFOP,TGFCAB.NULOTECTE AS NULOTECTE,TGFCAB.NULOTENFCOM
AS NULOTENFCOM,TGFCAB.NULOTENFE AS NULOTENFE,TGFCAB.NULOTENFSE AS NULOTENFSE,TGFCAB.NUMALEATORIO AS NUMALEATORIO,TGFCAB.NUMALEATORIOCTE AS NUMALEATORIOCTE,TGFCAB.NUMCF AS NUMCF,TGFCAB.NUMCONTRATO AS NUMCONTRATO,TGFCAB.NUMCOTACAO AS NUMCOTACAO,TGFCAB.NUMCSTC AS NUMCSTC,TGFCAB.NUMDOCARRECAD AS NUMDOCARRECAD,TGFCAB.NUMERACAOVOLUMES AS NUMERACAOVOLUMES,TGFCAB.NUMGUIA AS NUMGUIA,TGFCAB.NUMNFSE AS NUMNFSE,TGFCAB.NUMNOTA AS NUMNOTA,TGFCAB.NUMOS AS NUMOS,TGFCAB.NUMPEDIDO2 AS NUMPEDIDO2,TGFCAB.NUMPROTOC AS NUMPROTOC,TGFCAB.NUMPROTOCCTE AS NUMPROTOCCTE,TGFCAB.NUMPROTOCINCTE AS NUMPROTOCINCTE,TGFCAB.NUMPROTOCINNFE AS NUMPROTOCINNFE,TGFCAB.NUMPROTOCNFCOM AS NUMPROTOCNFCOM,TGFCAB.NUMRECEITAGRO AS NUMRECEITAGRO,TGFCAB.NUMREGDPEC AS NUMREGDPEC,TGFCAB.NUMTERMTEL AS NUMTERMTEL,TGFCAB.NUNOTA AS NUNOTA,TGFCAB.NUNOTAPEDFRET AS NUNOTAPEDFRET,TGFCAB.NUNOTAREC AS NUNOTAREC,TGFCAB.NUNOTASUB AS NUNOTASUB,TGFCAB.NUODP AS NUODP,TGFCAB.NUPCA AS NUPCA,TGFCAB.NUPEDFRETE AS NUPEDFRETE,TGFCAB.NURD8 AS NURD8,TGFCAB.NURECEBIMENTO AS NURECEBIMENTO,TGFCAB.NUREM AS NUREM,TGFCAB.NUSESSAO AS NUSESSAO,TGFCAB.NUTRANSF AS NUTRANSF,TGFCAB.OBSERVACAO AS OBSERVACAO,TGFCAB.OCCN48 AS OCCN48,TGFCAB.ORDEMCARGA AS ORDEMCARGA,TGFCAB.PECCTT AS PECCTT,TGFCAB.PECLIBPEDIDO AS PECLIBPEDIDO,TGFCAB.PECMARGEM AS PECMARGEM,TGFCAB.PECNUNOTAORG AS PECNUNOTAORG,TGFCAB.PECORC AS PECORC,TGFCAB.PECORG AS PECORG,TGFCAB.PECPARC AS PECPARC,TGFCAB.PECRETLOC AS PECRETLOC,TGFCAB.PECSTATUSLIB AS PECSTATUSLIB,TGFCAB.PECUSU AS PECUSU,TGFCAB.PECUSULIBERADOR AS PECUSULIBERADOR,TGFCAB.PENDENTE
AS PENDENTE,TGFCAB.PERCDESC AS PERCDESC,TGFCAB.PERCDESCFOB AS PERCDESCFOB,TGFCAB.PERMALTERCENTRAL AS PERMALTERCENTRAL,TGFCAB.PESO AS PESO,TGFCAB.PESOBRUTO AS PESOBRUTO,TGFCAB.PESOBRUTOMANUAL AS PESOBRUTOMANUAL,TGFCAB.PESOLIQUIMANUAL AS PESOLIQUIMANUAL,TGFCAB.PLACA AS PLACA,TGFCAB.PREMIACAOESTADUAL AS PREMIACAOESTADUAL,TGFCAB.PRODPRED AS PRODPRED,TGFCAB.PRODUETLOC AS PRODUETLOC,TGFCAB.QTDUSU AS QTDUSU,TGFCAB.QTDVOL AS QTDVOL,TGFCAB.RATEADO AS RATEADO,TGFCAB.REBOQUE1 AS REBOQUE1,TGFCAB.REBOQUE2 AS REBOQUE2,TGFCAB.REBOQUE3 AS REBOQUE3,TGFCAB.REGESPTRIBUT AS REGESPTRIBUT,TGFCAB.RETGERWMS AS RETGERWMS,TGFCAB.RETORNOEQUIPFISCAL AS RETORNOEQUIPFISCAL,TGFCAB.SEQCARGA AS SEQCARGA,TGFCAB.SERIEGUIA AS SERIEGUIA,TGFCAB.SERIENFDES AS SERIENFDES,TGFCAB.SERIENFSE AS SERIENFSE,TGFCAB.SERIENOTA AS SERIENOTA,TGFCAB.SITESPECIALRESP AS SITESPECIALRESP,TGFCAB.SITUACAOCTE AS SITUACAOCTE,TGFCAB.SITUACAONFCOM AS SITUACAONFCOM,TGFCAB.SOMDESPADUNFENAC AS SOMDESPADUNFENAC,TGFCAB.SOMICMSNFENAC AS SOMICMSNFENAC,TGFCAB.SOMPISCOFNFENAC AS SOMPISCOFNFENAC,TGFCAB.STATUSCFE AS STATUSCFE,TGFCAB.STATUSCTE AS STATUSCTE,TGFCAB.STATUSNFCOM AS STATUSNFCOM,TGFCAB.STATUSNFE AS STATUSNFE,TGFCAB.STATUSNFSE AS STATUSNFSE,TGFCAB.STATUSNOTA AS STATUSNOTA,TGFCAB.SUMVLRIIOUTNOTA AS SUMVLRIIOUTNOTA,TGFCAB.TERMACORDNOTA AS TERMACORDNOTA,TGFCAB.TIMCONTRATOLTV AS TIMCONTRATOLTV,TGFCAB.TIMCONTRATOVENDA AS TIMCONTRATOVENDA,TGFCAB.TIMNUFINORIG AS TIMNUFINORIG,TGFCAB.TIMNUNOTAMOD AS TIMNUNOTAMOD,TGFCAB.TIMORIGEM AS TIMORIGEM,TGFCAB.TIPCLIENTESERVCOM AS TIPCLIENTESERVCOM,TGFCAB.TIPFRETE AS TIPFRETE,TGFCAB.TIPIPIEMB AS TIPIPIEMB,TGFCAB.TIPMOV AS TIPMOV,TGFCAB.TIPNOTAPMB AS TIPNOTAPMB,TGFCAB.TIPOGUIA
AS TIPOGUIA,TGFCAB.TIPOPTAGJNFE AS TIPOPTAGJNFE,TGFCAB.TIPPROCIMP AS TIPPROCIMP,TGFCAB.TOTALCUSTOPROD AS TOTALCUSTOPROD,TGFCAB.TOTALCUSTOSERV AS TOTALCUSTOSERV,TGFCAB.TOTDISPDESC AS TOTDISPDESC,TGFCAB.TPAMBCTE AS TPAMBCTE,TGFCAB.TPAMBNFCOM AS TPAMBNFCOM,TGFCAB.TPAMBNFE AS TPAMBNFE,TGFCAB.TPAMBNFSE AS TPAMBNFSE,TGFCAB.TPASSINANTE AS TPASSINANTE,TGFCAB.TPEMISCTE AS TPEMISCTE,TGFCAB.TPEMISNFCOM AS TPEMISNFCOM,TGFCAB.TPEMISNFE AS TPEMISNFE,TGFCAB.TPEMISNFSE AS TPEMISNFSE,TGFCAB.TPFRETAMENTO AS TPFRETAMENTO,TGFCAB.TPLIGACAO AS TPLIGACAO,TGFCAB.TPRETISS AS TPRETISS,TGFCAB.TROCO AS TROCO,TGFCAB.UFADQUIRENTE AS UFADQUIRENTE,TGFCAB.UFEMBARQ AS UFEMBARQ,TGFCAB.UFEMISS AS UFEMISS,TGFCAB.UFEMISSAO AS UFEMISSAO,TGFCAB.UFVEICULO AS UFVEICULO,TGFCAB.VALORDESONPISCOFINS AS VALORDESONPISCOFINS,TGFCAB.VENCFRETE AS VENCFRETE,TGFCAB.VENCIPI AS VENCIPI,TGFCAB.VIATRANSP AS VIATRANSP,TGFCAB.VLRAFRMM AS VLRAFRMM,TGFCAB.VLRCARGAAVERB AS VLRCARGAAVERB,TGFCAB.VLRCOFINS AS VLRCOFINS,TGFCAB.VLRCOFINSST AS VLRCOFINSST,TGFCAB.VLRDESCPARCERIA AS VLRDESCPARCERIA,TGFCAB.VLRDESCSERV AS VLRDESCSERV,TGFCAB.VLRDESCTOT AS VLRDESCTOT,TGFCAB.VLRDESCTOTITEM AS VLRDESCTOTITEM,TGFCAB.VLRDESCTOTITEMMOE AS VLRDESCTOTITEMMOE,TGFCAB.VLRDESTAQUE AS VLRDESTAQUE,TGFCAB.VLREMB AS VLREMB,TGFCAB.VLRFETHAB AS VLRFETHAB,TGFCAB.VLRFRETE AS VLRFRETE,TGFCAB.VLRFRETECALC AS VLRFRETECALC,TGFCAB.VLRFRETECPL AS VLRFRETECPL,TGFCAB.VLRFRETETOTAL AS VLRFRETETOTAL,TGFCAB.VLRICMS AS VLRICMS,TGFCAB.VLRICMSAT AS VLRICMSAT,TGFCAB.VLRICMSDIFALDEST AS VLRICMSDIFALDEST,TGFCAB.VLRICMSDIFALREM AS VLRICMSDIFALREM,TGFCAB.VLRICMSEMB AS VLRICMSEMB,TGFCAB.VLRICMSFCP AS VLRICMSFCP,TGFCAB.VLRICMSFCPINT
AS VLRICMSFCPINT,TGFCAB.VLRICMSSEG AS VLRICMSSEG,TGFCAB.VLRINDENIZ AS VLRINDENIZ,TGFCAB.VLRINDENIZDIST AS VLRINDENIZDIST,TGFCAB.VLRINSS AS VLRINSS,TGFCAB.VLRIPI AS VLRIPI,TGFCAB.VLRIRF AS VLRIRF,TGFCAB.VLRISS AS VLRISS,TGFCAB.VLRJURO AS VLRJURO,TGFCAB.VLRJURODIST AS VLRJURODIST,TGFCAB.VLRLIQITEMNFE AS VLRLIQITEMNFE,TGFCAB.VLRMERCADORIA AS VLRMERCADORIA,TGFCAB.VLRMOEDA AS VLRMOEDA,TGFCAB.VLRNOTA AS VLRNOTA,TGFCAB.VLROUTROS AS VLROUTROS,TGFCAB.VLRPIS AS VLRPIS,TGFCAB.VLRPISST AS VLRPISST,TGFCAB.VLRPRESTAFRMM AS VLRPRESTAFRMM,TGFCAB.VLRREPREDST AS VLRREPREDST,TGFCAB.VLRREPREDTOT AS VLRREPREDTOT,TGFCAB.VLRREPREDTOTSEMDESC AS VLRREPREDTOTSEMDESC,TGFCAB.VLRREPTERC AS VLRREPTERC,TGFCAB.VLRROYALT AS VLRROYALT,TGFCAB.VLRSEG AS VLRSEG,TGFCAB.VLRSTEXTRANOTATOT AS VLRSTEXTRANOTATOT,TGFCAB.VLRSTFCPINT AS VLRSTFCPINT,TGFCAB.VLRSTFCPINTANT AS VLRSTFCPINTANT,TGFCAB.VLRSUBST AS VLRSUBST,TGFCAB.VLRTOTLIQITEMMOE AS VLRTOTLIQITEMMOE,TGFCAB.VLRVENDOR AS VLRVENDOR,TGFCAB.VOLUME AS VOLUME, (
SELECT GC_GET_DADOS(4,TGFCAB.NUNOTA) FROM DUAL) AS AD_DESCROTA, (
SELECT GC_GET_DADOS(3,TGFCAB.NUNOTA) FROM DUAL) AS AD_DTROTA, (
SELECT GC_GET_DADOS(6,TGFCAB.NUNOTA) FROM DUAL) AS AD_EMPRESA, (
SELECT GC_GET_DADOS(3,TGFCAB.NUNOTA) FROM DUAL) AS AD_STATUSROTA, (
SELECT GC_GET_DADOS(1,TGFCAB.NUNOTA) FROM DUAL) AS AD_UNID_NEGOCIO, (
SELECT GC_GET_DADOS(2,TGFCAB.NUNOTA) FROM DUAL) AS AD_UNID_NEGOCIO_DESCR, (
SELECT V.CODAUTORIZACAOVENDAMAIS AS CODAUTHVM FROM TGFCABVM V WHERE V.NUNOTA = TGFCAB.NUNOTA AND (V.ESTORNADO IS NULL OR V.ESTORNADO <> 'S')) AS CODAUTHVM, ( CASE WHEN TGFCAB.STATUSNOTA = 'L' THEN 'Sim' ELSE 'N鉶' END) AS CONFIRMADA, ( CASE WHEN (SELECT COUNT(*) FROM TCBINT T WHERE T.ORIGEM = 'E' AND T.NUNICO = TGFCAB.NUNOTA) > 0 THEN 'S' ELSE 'N' END) AS CONTABILIZADO, ( CASE WHEN TGFCAB.TERMACORDNOTA='S' AND EXISTS(SELECT 1 FROM TGFTOP WHERE TGFTOP.CODTIPOPER=TGFCAB.CODTIPOPER AND TGFTOP.DHALTER = TGFCAB.DHTIPOPER AND TGFTOP.CODMODDOC IN (67,57)) THEN TGFCAB.VLRICMS ELSE 0 END) AS DESCTERMACORD, ( SELECT T.DTVALIDADE AS DTVALAUTVENDAMAIS FROM
TGFCABVM T WHERE T.NUNOTA = TGFCAB.NUNOTA AND T.CODOPERACAOVENDAMAIS IS NULL AND (T.ESTORNADO IS NULL OR T.ESTORNADO <> 'S')) AS DTVALAUTVENDAMAIS, ( SELECT TGFTOP.TIPOEMISSAONFCOM FROM TGFTOP WHERE TGFTOP.CODTIPOPER = TGFCAB.CODTIPOPER AND TGFTOP.DHALTER = TGFCAB.DHTIPOPER AND TGFTOP.CODMODDOC = 62) AS NFCOM, (
SELECT
SUM(NVL(PRO.PESOLIQ, 0) * I.QTDNEG)
FROM TGFITE I
INNER JOIN TGFPRO PRO ON(PRO.CODPROD = I.CODPROD)
WHERE
I.SEQUENCIA > 0
AND I.NUNOTA = TGFCAB.NUNOTA) AS PESOLIQITENS, (
							SELECT COUNT(DISTINCT CODPROD)
							FROM TGFITE
							WHERE NUNOTA = TGFCAB.NUNOTA) AS QTDPRODDISTINTOS, (
SELECT
(NVL(
  CASE
       WHEN (TPO.UTILIZAWMS = 'N' OR TGFCAB.TIPMOV NOT IN ('C','O','P','V','D','E','J','Q','L','T'))  THEN
-1
       WHEN TGFCAB.TIPMOV IN ('C','O','D') THEN
         NVL((SELECT VREC.COD_SITUACAO FROM VGWRECSITCAB VREC WHERE VREC.NUNOTA = TGFCAB.NUNOTA), -1)
       WHEN TGFCAB.TIPMOV IN ('T') AND TPO.TIPATUALWMS = 'E' THEN
         NVL((SELECT VREC.COD_SITUACAO FROM VGWRECSITCAB VREC WHERE VREC.NUNOTA = TGFCAB.NUNOTA), -1)
       WHEN TGFCAB.TIPMOV IN ('P','V','E','T','J') THEN
         NVL((SELECT VSEP.COD_SITUACAO FROM VGWSEPSITCAB VSEP WHERE VSEP.NUNOTA = TGFCAB.NUNOTA), -1)
   END , -1)) AS SITUACAOWMS
FROM TGFTOP TPO
  WHERE TPO.CODTIPOPER = TGFCAB.CODTIPOPER
    AND TPO.DHALTER = TGFCAB.DHTIPOPER) AS SITUACAOWMS, (
	      SELECT
				CASE
					WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.ESTORNADO = 'N' AND EXISTS(SELECT 1 FROM TGFCABVM WHERE CODAUTORIZACAOVENDAMAIS = V.CODAUTORIZACAOVENDAMAIS) AND V.TIPMOV = 'P' AND V.DTVALIDADE > SYSDATE THEN 'A'
					WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.ESTORNADO = 'S' THEN 'C'
					WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.ESTORNADO = 'N' AND EXISTS(SELECT 1 FROM TGFCABVM WHERE CODAUTORIZACAOVENDAMAIS = V.CODAUTORIZACAOVENDAMAIS AND TIPMOV = 'V' AND CODOPERACAOVENDAMAIS IS NOT NULL) AND V.TIPMOV = 'P' THEN 'U'
					WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.ESTORNADO
= 'N' AND EXISTS(SELECT 1 FROM TGFCABVM WHERE CODAUTORIZACAOVENDAMAIS = V.CODAUTORIZACAOVENDAMAIS) AND V.DTVALIDADE < SYSDATE THEN 'E'
					ELSE NULL
				END AS STATUSAUTORIZACAOVM
				FROM
					TGFCABVM V
				WHERE
					V.NUNOTA = TGFCAB.NUNOTA) AS STATUSAUTORIZACAOVM, (
	     SELECT
			CASE
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.CODOPERACAOVENDAMAIS IS NULL AND (TGFCAB.STATUSNFE IS NULL OR TGFCAB.STATUSNFE <> 'A') THEN 'N'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.CODOPERACAOVENDAMAIS IS NULL AND TGFCAB.STATUSNFE = 'A' THEN 'E'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NOT NULL AND V.CODOPERACAOVENDAMAIS IS NOT NULL AND TGFCAB.STATUSNFE = 'A' THEN 'A'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NULL AND V.CODOPERACAOVENDAMAIS IS NULL AND V.TIPMOV = 'D' AND ((SELECT QTD FROM TGFFILAINTVM WHERE NUCHAVE = V.NUNOTA)
= (SELECT QTDMAX FROM TGFFILAINTVM WHERE NUCHAVE = V.NUNOTA)) AND TGFCAB.STATUSNFE = 'A' THEN 'F'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NULL AND V.CODOPERACAOVENDAMAIS IS NULL AND V.TIPMOV = 'D' AND TGFCAB.STATUSNFE = 'A' AND NOT EXISTS(SELECT 1 FROM TGFFILAINTVM WHERE NUCHAVE = V.NUNOTA) THEN 'F'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NULL AND V.CODOPERACAOVENDAMAIS IS NOT NULL AND V.TIPMOV = 'D' AND TGFCAB.STATUSNFE = 'A' THEN 'D'
				WHEN V.CODAUTORIZACAOVENDAMAIS IS NULL AND V.CODOPERACAOVENDAMAIS IS NULL AND V.TIPMOV = 'D' AND TGFCAB.STATUSNFE = 'A' THEN 'P'
				ELSE NULL
				END AS STATUSVM
	   FROM
		 	TGFCABVM V
	   WHERE
			V.NUNOTA = TGFCAB.NUNOTA
	   AND
			V.TIPMOV IN('V','D')) AS STATUSVM, (
SELECT
		(NVL(
		CASE WHEN (TPO.UTILIZAWMS
='N' OR TGFCAB.TIPMOV NOT IN ('C','O','P','V','D','E','J','Q','L','T')) THEN 4
	     WHEN (SELECT COUNT(*) FROM TGFEMP E WHERE E.CODEMP = TGFCAB.CODEMP AND (E.UTILIZAWMS ='S')) = 0 THEN 4
	     WHEN (TPO.TIPATUALWMS ='E') THEN
	            CASE WHEN (SELECT DISTINCT 1 FROM TGWREC REC, TGWRXN RXN WHERE RXN.NUNOTA = TGFCAB.NUNOTA) IS NULL THEN 3 ELSE 1 END
	ELSE
	      (SELECT
	         CASE WHEN SUM(CASE WHEN (P.UTILIZAWMS ='S' AND L.UTILIZAWMS ='S') THEN I.QTDNEG ELSE 0 END) = 0 THEN
4
		          WHEN (NVL(SUM(NVL(I.QTDWMS,0)),0) = 0) AND (SUM(I.QTDNEG) = SUM(I.QTDCONFERIDA)) THEN 5
	              WHEN (NVL(SUM(NVL(I.QTDWMS,0)),0) = 0) AND (SUM(I.QTDCONFERIDA) <> 0) AND (SUM(I.QTDNEG) <> SUM(I.QTDCONFERIDA)) THEN 0
	              WHEN (NVL(SUM(NVL(I.QTDWMS,0)),0) = 0)  THEN 3
	              WHEN (NVL(SUM(NVL(I.QTDWMS,0)),0) = SUM(CASE WHEN (P.UTILIZAWMS ='S') THEN I.QTDNEG ELSE 0 END)) THEN 1 ELSE 2 END
FROM TGFITE I, TGFPRO P, TGFEMP E, TGFLOC L
	       WHERE I.NUNOTA = TGFCAB.NUNOTA
	       AND I.CODEMP = E.CODEMP AND I.CODPROD = P.CODPROD AND I.CODLOCALORIG = L.CODLOCAL  AND I.SEQUENCIA > 0) END , '')) AS COD_STATUSWMS
	FROM TGFTOP TPO
  WHERE TPO.CODTIPOPER = TGFCAB.CODTIPOPER
    AND TPO.DHALTER = TGFCAB.DHTIPOPER) AS STATUSWMS, ( SELECT MAX(CODPROD) CODPROD FROM TGFITE WHERE NUNOTA = (SELECT TGFCAB.NUNOTA FROM DUAL)) AS TIMCODPROD, (
SELECT DESCRPROD FROM TGFPRO WHERE CODPROD = (SELECT MAX(CODPROD) FROM TGFITE WHERE NUNOTA = (SELECT TGFCAB.NUNOTA FROM DUAL)))
AS TIMDESCPROD, (
SELECT TPO.TIPOCTE
FROM TGFTOP TPO
WHERE
TPO.CODTIPOPER = TGFCAB.CODTIPOPER
AND TPO.DHALTER = TGFCAB.DHALTER) AS TIPOCTE, (
SELECT TPO.TIPSERVCTE
FROM TGFTOP TPO
WHERE
TPO.CODTIPOPER = TGFCAB.CODTIPOPER
AND TPO.DHALTER = TGFCAB.DHALTER) AS TIPSERVCTE, ( SELECT SUM(NVL(CASE WHEN (I.CODTRIB = 51 AND I.CODCFO LIKE '3%') THEN I.VLRICMSDIFERIDO ELSE 0 END, 0)) FROM TGFITE I WHERE I.NUNOTA = TGFCAB.NUNOTA) AS VLRICMSDIFERIDO , CentroResultado.DESCRCENCUS AS l0_DESCRCENCUS,Cidade.NOMECID AS l1_NOMECID,CidadeDestino.NOMECID AS l2_NOMECID,CidadeOrigem.NOMECID AS l3_NOMECID,CidadeTrabalho.NOMECID AS l4_NOMECID,Contato.NOMECONTATO AS l5_NOMECONTATO,Contato.NOMECONTATO AS l5_NOMECONTATO,ContatoEntrega.NOMECONTATO AS l6_NOMECONTATO,Empresa.NOMEFANTASIA AS l7_NOMEFANTASIA,Empresa.NOMEFANTASIA AS l7_NOMEFANTASIA,Empresa.CGC AS l7_CGC,Cidade8_1.CODCID AS l8_CODCID,Cidade8_1.CODMUNFIS AS l8_CODMUNFIS,Cidade8_1.TEMSUBSTITNFSE AS l8_TEMSUBSTITNFSE,Cidade8_1.ACTCANEXNT AS l8_ACTCANEXNT,UnidadeFederativa9_2.UF AS l9_UF,EmpresaFinanceiro10_1.CONECTORNFSE AS l10_CONECTORNFSE,EmpresaFinanceiro10_1.PRZREGCANNOTA AS l10_PRZREGCANNOTA,EmpresaFinanceiro10_1.PRZTOLCANNOTA AS l10_PRZTOLCANNOTA,EmpresaFinanceiro10_1.TEMDENUESPONT AS l10_TEMDENUESPONT,EmpresaFinanceiro10_1.STATUS AS l10_STATUS,EmpresaFuncionario.NOMEFANTASIA AS l11_NOMEFANTASIA,EmpresaNegociacao.NOMEFANTASIA AS l12_NOMEFANTASIA,Empresa_AD001.NOMEFANTASIA AS l13_NOMEFANTASIA,FinalidadeOperacao.DESCRICAO
AS l14_DESCRICAO,Funcionario.NOMEFUNC AS l15_NOMEFUNC,Funcionario.NOMEFUNC AS l15_NOMEFUNC,LocalFinanceiro.DESCRLOCAL AS l16_DESCRLOCAL,LoteNotaFiscalEletronica.NUMRECEB AS l17_NUMRECEB,LoteNotaFiscalEletronica.DHRECEB AS l17_DHRECEB,Moeda.NOMEMOEDA AS l18_NOMEMOEDA,Moeda.NOMEMOEDA AS l18_NOMEMOEDA,Motorista.NOMEPARC AS l19_NOMEPARC,Natureza.DESCRNAT AS l20_DESCRNAT,Natureza.DESCRNAT AS l20_DESCRNAT,ObservacaoNotasFiscais.OBSERVACAO AS l21_OBSERVACAO,PATRIMONIO_AD001_AD001.DESCBEM AS l22_DESCBEM,Parceiro.NOMEPARC AS l23_NOMEPARC,Parceiro.NOMEPARC AS l23_NOMEPARC,Parceiro.TIPOFATUR AS l23_TIPOFATUR,ParceiroConsignatario.NOMEPARC AS l24_NOMEPARC,ParceiroDescargaMdfe.NOMEPARC AS l25_NOMEPARC,ParceiroDestino.NOMEPARC AS l26_NOMEPARC,ParceiroIntermed.NOMEPARC AS l27_NOMEPARC,ParceiroRedespacho.NOMEPARC AS l28_NOMEPARC,ParceiroRemetente.NOMEPARC AS l29_NOMEPARC,ParceiroRetirada AS ParceiroRetirada.NOMEPARC,PecUsuario.NOME AS l31_NOME,PecUsuario2.NOME AS l32_NOME,Projeto.IDENTIFICACAO AS l33_IDENTIFICACAO,Projeto.IDENTIFICACAO AS l33_IDENTIFICACAO,Regiao.NOMEREG AS l34_NOMEREG,Site.NOMESITE AS l35_NOMESITE,TabelaCalculoFrete.DESCRCALCFRET AS l36_DESCRCALCFRET,TipoNegociacao.DESCRTIPVENDA AS l37_DESCRTIPVENDA,TipoNegociacao.DESCRTIPVENDA AS l37_DESCRTIPVENDA,TipoNegociacao.EXVENDAMAIS AS l37_EXVENDAMAIS,TipoNegociacao.FIXAVENC AS l37_FIXAVENC,TipoOperacao.DESCROPER AS l38_DESCROPER,TipoOperacao.DESCROPER AS l38_DESCROPER,TipoOperacao.ATUALFIN AS l38_ATUALFIN,TipoOperacao.ATUALEST AS l38_ATUALEST,TipoOperacao.SOLCOMPRA AS l38_SOLCOMPRA,TipoOperacao.CODMODDOC AS l38_CODMODDOC,TipoOperacao.TRANSFWMS AS l38_TRANSFWMS,TipoOperacao.NFE AS l38_NFE,TipoOperacao.BASENUMERACAO AS l38_BASENUMERACAO,TipoOperacao.NFSE AS l38_NFSE,TipoOperacao.TIPATUALWMS AS l38_TIPATUALWMS,TipoPedido.DESCRICAO AS l39_DESCRICAO,TipoTitulo.DESCRTIPTIT AS l40_DESCRTIPTIT,Transportadora.NOMEPARC AS l41_NOMEPARC,Transportadora.NOMEPARC AS l41_NOMEPARC,TransportadoraFinal.NOMEPARC AS l42_NOMEPARC,UnidadeFederativa.UF
AS l43_UF,UnidadeFederativaEmissao.UF AS l44_UF,Usuario.NOMEUSU AS l45_NOMEUSU,Usuario2.NOMEUSU AS l46_NOMEUSU,Usuario_AD001.NOMEUSU AS l47_NOMEUSU,Usuario_AD002.NOMEUSU AS l48_NOMEUSU,Usuario_AD003.NOMEUSU AS l49_NOMEUSU,Usuario_AD004.NOMEUSU AS l50_NOMEUSU,Vendedor.APELIDO AS l51_APELIDO,Vendedor.APELIDO AS l51_APELIDO,Vendedor2.APELIDO AS l52_APELIDO,Vendedor_AD001.APELIDO AS l53_APELIDO,ViaTransporte.DESCRICAO AS l54_DESCRICAO FROM TGFCAB left join (SELECT DESCRCENCUS,CODCENCUS FROM TSICUS) CentroResultado ON(TGFCAB.CODCENCUS = CentroResultado.CODCENCUS) left join (SELECT NOMECID,CODCID FROM TSICID) Cidade ON(TGFCAB.CODCID = Cidade.CODCID) left join (SELECT NOMECID,CODCID FROM TSICID) CidadeDestino ON(TGFCAB.CODCIDFIMCTE = CidadeDestino.CODCID) left join (SELECT NOMECID,CODCID FROM TSICID) CidadeOrigem ON(TGFCAB.CODCIDINICTE = CidadeOrigem.CODCID) left join (SELECT NOMECID,CODCID FROM TSICID) CidadeTrabalho ON(TGFCAB.CODCIDPREST = CidadeTrabalho.CODCID) left join (SELECT NOMECONTATO,CODPARC,CODCONTATO FROM TGFCTT) Contato ON(TGFCAB.CODPARC = Contato.CODPARC AND TGFCAB.CODCONTATO = Contato.CODCONTATO) left
join (SELECT NOMECONTATO,CODPARC,CODCONTATO FROM TGFCTT) ContatoEntrega ON(TGFCAB.CODPARC = ContatoEntrega.CODPARC AND TGFCAB.CODCONTATOENTREGA = ContatoEntrega.CODCONTATO) left join (SELECT NOMEFANTASIA,CODCID,CODEMP,CGC FROM TSIEMP) Empresa ON(TGFCAB.CODEMP = Empresa.CODEMP) left join (SELECT UF,CODMUNFIS,CODCID,ACTCANEXNT,TEMSUBSTITNFSE FROM TSICID) Cidade8_1 ON(Empresa.CODCID = Cidade8_1.CODCID) left join (SELECT UF,CODUF FROM TSIUFS) UnidadeFederativa9_2 ON(Cidade8_1.UF = UnidadeFederativa9_2.CODUF) left join (SELECT STATUS,CONECTORNFSE,PRZREGCANNOTA,TEMDENUESPONT,PRZTOLCANNOTA,CODEMP FROM TGFEMP) EmpresaFinanceiro10_1 ON(Empresa.CODEMP = EmpresaFinanceiro10_1.CODEMP) left join (SELECT NOMEFANTASIA,CODEMP FROM TSIEMP) EmpresaFuncionario ON(TGFCAB.CODEMPFUNC = EmpresaFuncionario.CODEMP) left join (SELECT NOMEFANTASIA,CODEMP FROM TSIEMP) EmpresaNegociacao ON(TGFCAB.CODEMPNEGOC = EmpresaNegociacao.CODEMP) left join (SELECT NOMEFANTASIA,CODEMP FROM TSIEMP) Empresa_AD001 ON(TGFCAB.AD_EMPTRANDEST = Empresa_AD001.CODEMP) left join (SELECT NUFOP,DESCRICAO FROM TGFFOP) FinalidadeOperacao ON(TGFCAB.NUFOP
= FinalidadeOperacao.NUFOP) left join (SELECT CODFUNC,NOMEFUNC,CODEMP FROM TFPFUN) Funcionario ON(TGFCAB.CODEMPFUNC = Funcionario.CODEMP AND TGFCAB.CODFUNC = Funcionario.CODFUNC) left join (SELECT DESCRLOCAL,CODLOCAL FROM TGFLOC) LocalFinanceiro ON(TGFCAB.AD_CODLOCAL = LocalFinanceiro.CODLOCAL) left join (SELECT NULOTE,NUMRECEB,DHRECEB FROM TGFLNF) LoteNotaFiscalEletronica ON(TGFCAB.NULOTENFE = LoteNotaFiscalEletronica.NULOTE) left join (SELECT NOMEMOEDA,CODMOEDA FROM TSIMOE) Moeda ON(TGFCAB.CODMOEDA = Moeda.CODMOEDA) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) Motorista ON(TGFCAB.CODMOTORISTA = Motorista.CODPARC) left join (SELECT DESCRNAT,CODNAT FROM TGFNAT) Natureza ON(TGFCAB.CODNAT = Natureza.CODNAT) left join (SELECT CODOBSPADRAO,OBSERVACAO FROM TGFOBS) ObservacaoNotasFiscais ON(TGFCAB.CODOBSPADRAO = ObservacaoNotasFiscais.CODOBSPADRAO) left join (SELECT DESCBEM,CODBEM FROM AD_PATRIMONIO) PATRIMONIO_AD001_AD001 ON(TGFCAB.AD_PATRIMONIO = PATRIMONIO_AD001_AD001.CODBEM) left join (SELECT NOMEPARC,TIPOFATUR,CODPARC FROM TGFPAR)
Parceiro ON(TGFCAB.CODPARC = Parceiro.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroConsignatario ON(TGFCAB.CODPARCCONSIGNATARIO = ParceiroConsignatario.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroDescargaMdfe ON(TGFCAB.CODPARCDESCARGAMDFE = ParceiroDescargaMdfe.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroDestino ON(TGFCAB.CODPARCDEST = ParceiroDestino.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroIntermed ON(TGFCAB.CODINTERM = ParceiroIntermed.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroRedespacho ON(TGFCAB.CODPARCREDESPACHO = ParceiroRedespacho.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroRemetente ON(TGFCAB.CODPARCREMETENTE = ParceiroRemetente.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) ParceiroRetirada ON(TGFCAB.CODPARCRETIRADA = ParceiroRetirada.CODPARC) left join (SELECT CODUSU,NOME FROM PECUSU) PecUsuario ON(TGFCAB.PECUSU = PecUsuario.CODUSU) left join (SELECT CODUSU,NOME FROM PECUSU) PecUsuario2
ON(TGFCAB.PECUSULIBERADOR = PecUsuario2.CODUSU) left join (SELECT CODPROJ,IDENTIFICACAO FROM TCSPRJ) Projeto ON(TGFCAB.CODPROJ = Projeto.CODPROJ) left join (SELECT CODREG,NOMEREG FROM TSIREG) Regiao ON(TGFCAB.AD_CODREG = Regiao.CODREG) left join (SELECT NOMESITE,CODSITE FROM TGFSIT) Site ON(TGFCAB.CODSITE = Site.CODSITE) left join (SELECT NUCFR,DESCRCALCFRET FROM TGFCFR) TabelaCalculoFrete ON(TGFCAB.NUCFR = TabelaCalculoFrete.NUCFR) left join (SELECT DESCRTIPVENDA,CODTIPVENDA,DHALTER,EXVENDAMAIS,FIXAVENC FROM TGFTPV) TipoNegociacao ON(TGFCAB.CODTIPVENDA = TipoNegociacao.CODTIPVENDA AND TGFCAB.DHTIPVENDA = TipoNegociacao.DHALTER) left join (SELECT BASENUMERACAO,CODTIPOPER,TIPATUALWMS,ATUALEST,ATUALFIN,CODMODDOC,SOLCOMPRA,TRANSFWMS,NFE,DHALTER,DESCROPER,NFSE FROM TGFTOP) TipoOperacao ON(TGFCAB.CODTIPOPER = TipoOperacao.CODTIPOPER AND TGFCAB.DHTIPOPER = TipoOperacao.DHALTER) left join (SELECT DESCRICAO,CODTPD FROM TGFTPD) TipoPedido ON(TGFCAB.CODTPD = TipoPedido.CODTPD) left join (SELECT CODTIPTIT,DESCRTIPTIT FROM TGFTIT) TipoTitulo ON(TGFCAB.AD_CODTIPTIT = TipoTitulo.CODTIPTIT)
left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) Transportadora ON(TGFCAB.CODPARCTRANSP = Transportadora.CODPARC) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) TransportadoraFinal ON(TGFCAB.CODPARCTRANSPFINAL = TransportadoraFinal.CODPARC) left join (SELECT UF,CODUF FROM TSIUFS) UnidadeFederativa ON(TGFCAB.UFVEICULO = UnidadeFederativa.CODUF) left join (SELECT UF,CODUF FROM TSIUFS) UnidadeFederativaEmissao ON(TGFCAB.UFEMISS = UnidadeFederativaEmissao.CODUF) left join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario ON(TGFCAB.CODUSU = Usuario.CODUSU) left join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario2 ON(TGFCAB.CODUSUINC = Usuario2.CODUSU) left join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario_AD001 ON(TGFCAB.AD_SOLICITANTE = Usuario_AD001.CODUSU) left join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario_AD002 ON(TGFCAB.AD_CODUSU = Usuario_AD002.CODUSU) left join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario_AD003 ON(TGFCAB.AD_CODUSUCONF = Usuario_AD003.CODUSU) left
join (SELECT CODUSU,NOMEUSU FROM TSIUSU) Usuario_AD004 ON(TGFCAB.AD_GESTOR = Usuario_AD004.CODUSU) left join (SELECT APELIDO,CODVEND FROM TGFVEN) Vendedor ON(TGFCAB.CODVEND = Vendedor.CODVEND) left join (SELECT APELIDO,CODVEND FROM TGFVEN) Vendedor2 ON(TGFCAB.CODVENDTEC = Vendedor2.CODVEND) left join (SELECT APELIDO,CODVEND FROM TGFVEN) Vendedor_AD001 ON(TGFCAB.AD_CONSULTOR = Vendedor_AD001.CODVEND) left join (SELECT CODVTP,DESCRICAO FROM TGFVTP) ViaTransporte ON(TGFCAB.CODVTP = ViaTransporte.CODVTP) WHERE (((NOT EXISTS (SELECT NUNOTA FROM TGFCAN WHERE TGFCAN.NUNOTA = TGFCAB.NUNOTA) AND TGFCAB.TIPMOV IN ('P', 'V', 'D') AND TGFCAB.CODPARC IN (703143)))) ORDER BY TGFCAB.NUNOTA